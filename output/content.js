function e(e){if(void 0!==e.port&&null!==e.port||(e.port=""),e.site===location.hostname&&e.port===location.port&&/\/login/gi.test(location.pathname)){let t=document.querySelector('input[name="username"]'),o=document.querySelector('input[name="password"]');e.handleBool&&(t=document.querySelector(e.handleAccount),o=document.querySelector(e.handlePasswd)),t&&o&&(t.value=e.fillAccount,t.dispatchEvent(new Event("input")),o.value=e.fillPasswd,o.dispatchEvent(new Event("input")))}}function t(e,t,o,n,l){let i=document.body.offsetWidth,r=document.body.offsetHeight;e>=i-46&&(t=i-46),e<=0&&(t=6),o>r-46&&(n=r-46),o<=0&&(n=6),l.style.top=n+"px",l.style.left=t+"px"}function o(e,t){if(!e)return void console.error("Console.save: No data");t||(t=`${t}.txt`),"object"==typeof e&&(e=JSON.stringify(e,void 0,4));let o=new Blob([e],{type:"text/plain"}),n=document.createEvent("MouseEvents"),l=document.createElement("a");l.download=t,l.href=window.URL.createObjectURL(o),l.dataset.downloadurl=["text/plain",l.download,l.href].join(":"),n.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),l.dispatchEvent(n)}function n(){let e=new Date;return e.getFullYear()+"-"+(e.getMonth()+1).toString().padStart(2,"0")+"-"+e.getDate().toString().padStart(2,"0")}window.addEventListener("load",(function(){const e=document.body;var t=document.createElement("script");t.setAttribute("type","text/javascript"),t.setAttribute("src",chrome.runtime.getURL("sdk.js")),e.appendChild(t)})),async function(){try{chrome.runtime.sendMessage({event:"getSiteList",data:null},(async o=>{o&&(null==o?void 0:o.siteList.length)&&function({siteList:o}){var n;let l=location.hostname;for(const i of o){if(i.site!==l)continue;let o=document.createElement("div");if(i.boxBool&&(o.setAttribute("id","ontextflag"),o.setAttribute("style","width: 100vw;height: 100vh;border: 6px solid transparent;box-sizing: border-box;position: fixed;top: 0;left: 0;z-index: 999999999;pointer-events: none;"),o.style.borderColor=i.boxColor,null==(n=document.body)||n.appendChild(o)),i.badgeBool){let e=document.createElement("div");if(e.setAttribute("id","ontextflaghander"),e.setAttribute("draggable","true"),e.setAttribute("style"," width: 40px;height: 40px;background-color: red;border-radius: 50%;position: absolute;top: 30px;right: 30px;line-height: 40px;text-align: center;color: white;cursor: move;pointer-events: all;user-select: none;font-size: 14px;"),o.appendChild(e),!e)return;e.innerText=i.badgeText,e.style.backgroundColor=i.badgeColor,chrome.runtime.sendMessage({event:"getFlagHostListPosition",data:null},(async e=>{if(Object.values(e).length&&(null==e?void 0:e.flagHostListPosition)){let[o,n]=e.flagHostListPosition,l=o,i=n;const r=document.getElementById("ontextflaghander");r&&o&&n&&t(o,l,n,i,r)}})),e.ondrag=t=>{const{x:o,y:n}=t;e.style.display="none",e.style.top=n-20+"px",e.style.left=o-20+"px"},e.ondragend=async o=>{const{x:n,y:l}=o;let i=n,r=l;e.style.display="unset",t(n,i,l,r,e),chrome.runtime.sendMessage({event:"setFlagHostListPosition",data:{flagHostListPosition:[i,r]}},(async e=>{}))}}i.fillBool&&e(i)}}({siteList:o.siteList})})),await async function(){await chrome.runtime.onMessage.addListener((function({event:e,data:t},o,n){if("easterEgg"===e)console.log("💐💐💐💐💐💐"),alert("💐💐💐💐💐💐");return!0}))}()}catch(o){console.info("插件报错，不用管",o)}}(),chrome.runtime.onMessage.addListener((function(e,t,l){"performAction"===e.action&&[...document.querySelectorAll('span[data-btm="d63429"]')].forEach((e=>{e.click()})),"toGetGoodsList"===e.action&&function(){let e=n(),t=[],l=document.querySelectorAll(".goods-list.shop-list > ul > li");for(let o of l)o.querySelector(".stall-recommend")&&o.querySelector(".stall-recommend").parentElement.querySelector("a").href&&t.push(o.querySelector(".stall-recommend").parentElement.querySelector("a").href);console.clear(),console.log(t.length);let i=document.querySelector(".slzz-stall-head-name a:first-child, .stall-head-name a:first-child h1").innerText;if(!t.length)return alert("没有抓取到商品");o(t.join("\n")+"\n",`${e}-${i}`)}(),"toGetAllGoodsList"===e.action&&function(){let e=n(),t=[],l=document.querySelectorAll(".goods-list.shop-list > ul > li");for(let o of l)t.push(o.querySelector("a").href);console.clear(),console.log(t.length);let i=document.querySelector(".slzz-stall-head-name a:first-child, .stall-head-name a:first-child h1").innerText;if(!t.length)return alert("没有抓取到商品");o(t.join("\n")+"\n",`${e}-${i}`)}(),"ignoreLittleStock"===e.action&&function(){let e=document.querySelectorAll("#fxzzGoodsListBox .ant-spin-container >.ant-row > div");for(let t of e)+t.querySelector(".antd-pro-components-goods-list-components-item-index-num").textContent<300&&t.querySelector(".ant-checkbox-wrapper-checked.antd-pro-components-goods-list-index-checkbox .ant-checkbox-checked .ant-checkbox-input").click()}()}));
